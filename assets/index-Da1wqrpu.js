(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))s(l);new MutationObserver(l=>{for(const r of l)if(r.type==="childList")for(const a of r.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&s(a)}).observe(document,{childList:!0,subtree:!0});function t(l){const r={};return l.integrity&&(r.integrity=l.integrity),l.referrerPolicy&&(r.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?r.credentials="include":l.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function s(l){if(l.ep)return;l.ep=!0;const r=t(l);fetch(l.href,r)}})();const W={story:{lives:0,bombRatio:.16,minStartClues:14,targetStartGivens:40,maxAdjStart:2,spreadRows:!0,spreadBlocks:!0,hintRows:5,hintCols:5,logicEnforcement:"hybrid",maxResidualUnknownCells:0,clusterize:!0,minClusters:6,clusterSizeMin:3,clusterSizeMax:5,supportPasses:2,bootstrapSteps:2,clueGivenRatio:.65},normal:{lives:0,bombRatio:.18,minStartClues:12,targetStartGivens:36,maxAdjStart:3,spreadRows:!0,spreadBlocks:!0,hintRows:4,hintCols:4,logicEnforcement:"hybrid",maxResidualUnknownCells:2,clusterize:!0,minClusters:5,clusterSizeMin:3,clusterSizeMax:5,supportPasses:2,bootstrapSteps:1,clueGivenRatio:.5},hard:{lives:0,bombRatio:.22,minStartClues:10,targetStartGivens:32,maxAdjStart:4,spreadRows:!0,spreadBlocks:!0,hintRows:3,hintCols:3,logicEnforcement:"hybrid",maxResidualUnknownCells:4,clusterize:!0,minClusters:4,clusterSizeMin:2,clusterSizeMax:4,supportPasses:2,bootstrapSteps:1,clueGivenRatio:.5},custom:{lives:0,bombRatio:.14,minStartClues:9,targetStartGivens:36,maxAdjStart:2,spreadRows:!0,spreadBlocks:!0,hintRows:3,hintCols:3,logicEnforcement:"hybrid",maxResidualUnknownCells:2,clusterize:!0,minClusters:5,clusterSizeMin:3,clusterSizeMax:5,supportPasses:2,bootstrapSteps:1,clueGivenRatio:2/3}},i=9,J=3,oe="runic-custom-config-v2";function re(){try{const o=localStorage.getItem(oe);return o?JSON.parse(o):null}catch(o){return console.error("Failed to load custom config:",o),null}}function se(o){try{return localStorage.setItem(oe,JSON.stringify(o)),!0}catch(e){return console.error("Failed to save custom config:",e),!1}}function ae(){return localStorage.getItem("runic-theme")||"dark"}function ce(o){localStorage.setItem("runic-theme",o)}let q=1,ne=null;function de(o){let e=2166136261;for(let t=0;t<o.length;t++)e^=o.charCodeAt(t),e=Math.imul(e,16777619);return e>>>0||1}function he(o){ne=String(o),q=de(ne)}function Q(){let o=q;return o^=o<<13,o^=o>>>17,o^=o<<5,q=o>>>0,q/4294967296}function _(o){for(let e=o.length-1;e>0;e--){const t=Math.floor(Q()*(e+1));[o[e],o[t]]=[o[t],o[e]]}return o}function fe(){return{solution:Array.from({length:i},()=>Array(i).fill(0)),bombs:Array.from({length:i},()=>Array(i).fill(!1)),adj:Array.from({length:i},()=>Array(i).fill(0)),entry:Array.from({length:i},()=>Array(i).fill(0)),revealed:Array.from({length:i},()=>Array(i).fill(!1)),flagged:Array.from({length:i},()=>Array(i).fill(!1)),flagNote:Array.from({length:i},()=>Array(i).fill(null)),noteText:Array.from({length:i},()=>Array(i).fill("")),given:Array.from({length:i},()=>Array(i).fill(!1))}}function le(o,e){return o>=0&&o<i&&e>=0&&e<i}function ee(o,e){const t=[];for(let s=-1;s<=1;s++)for(let l=-1;l<=1;l++){if(!s&&!l)continue;const r=o+s,a=e+l;le(r,a)&&t.push([r,a])}return t}const ue=250,me=5e4;function ge(o){let e=!1,t=null,s="Unknown error",l=0,r=[],a=[],c=[],f=[];for(let h=1;h<=ue;h++){const p=fe();p.solution=pe();const B=ve(o.bombRatio);p.bombs=B.bombs,l=B.count,p.adj=V(p.bombs),Ce(p,o.supportPasses??2),p.adj=V(p.bombs);const v=be(p);if(v<(o.minStartClues||0)){s=`Not enough clues (${v} < ${o.minStartClues})`;continue}const m=ye(p,o);r=m.hintedRows,a=m.hintedCols,c=m.rowTotals,f=m.colTotals;const E=we(p,o);p.given=E.givens;for(let k=0;k<i;k++)for(let R=0;R<i;R++)p.given[k][R]&&(p.revealed[k][R]=!0,p.entry[k][R]=p.solution[k][R]);if(Se(p)){s="Board has multiple Sudoku solutions";continue}const T=Be(p,o,r,a,c,f);if(!T.solvable){s=`Not logically solvable (steps: ${T.steps})`;continue}e=!0,t=p;break}return e?{success:!0,board:t,bombsTotal:l,hintedRows:r,hintedCols:a,rowTotals:c,colTotals:f}:{success:!1,error:s}}function pe(){const o=(a,c)=>(J*(a%J)+Math.floor(a/J)+c)%i,e=[0,1,2],t=[].concat(..._([0,1,2]).map(a=>_([...e]).map(c=>a*J+c))),s=[].concat(..._([0,1,2]).map(a=>_([...e]).map(c=>a*J+c))),l=_([1,2,3,4,5,6,7,8,9]),r=Array.from({length:i},()=>Array(i).fill(0));for(let a=0;a<i;a++)for(let c=0;c<i;c++)r[t[a]][s[c]]=l[o(a,c)];return r}function ve(o){const e=i*i,t=Math.max(1,Math.floor(e*o)),s=Array.from({length:i},()=>Array(i).fill(!1)),l=[];for(let r=0;r<i;r++)for(let a=0;a<i;a++)l.push([r,a]);_(l);for(let r=0;r<t;r++){const[a,c]=l[r];s[a][c]=!0}return{bombs:s,count:t}}function V(o){const e=Array.from({length:i},()=>Array(i).fill(0));for(let t=0;t<i;t++)for(let s=0;s<i;s++)e[t][s]=ee(t,s).reduce((l,[r,a])=>l+(o[r][a]?1:0),0);return e}function be(o){let e=0;for(let t=0;t<i;t++)for(let s=0;s<i;s++)!o.bombs[t][s]&&o.solution[t][s]===o.adj[t][s]&&e++;return e}function Ce(o,e=2){const t=(s,l,r)=>ee(s,l).reduce((a,[c,f])=>a+(!o.bombs[c][f]&&o.solution[c][f]===r[c][f]?1:0),0);for(let s=0;s<e;s++){let l=!1;for(let r=0;r<i;r++)for(let a=0;a<i;a++){if(!o.bombs[r][a]||t(r,a,o.adj)>=2)continue;let f=null,h=-1;for(let p=-2;p<=2;p++)for(let B=-2;B<=2;B++){const v=r+p,m=a+B;if(!le(v,m)||o.bombs[v][m])continue;o.bombs[r][a]=!1,o.bombs[v][m]=!0;const E=V(o.bombs);let k=t(v,m,E)>=2?1e3:0;if(k)for(let R=0;R<i;R++)for(let H=0;H<i;H++)!o.bombs[R][H]&&o.solution[R][H]===E[R][H]&&k++;o.bombs[r][a]=!0,o.bombs[v][m]=!1,k>h&&(h=k,f=[v,m])}if(f){const[p,B]=f;o.bombs[r][a]=!1,o.bombs[p][B]=!0,o.adj=V(o.bombs),l=!0}}if(!l)break}}function we(o,e){const t=Math.min(e.targetStartGivens||36,i*i-1),s=Math.max(0,Math.min(e.minStartClues||0,t)),l=[],r=[];for(let n=0;n<i;n++)for(let d=0;d<i;d++){if(o.bombs[n][d])continue;const C=o.solution[n][d]===o.adj[n][d],g={r:n,c:d,isClue:C,adj:o.adj[n][d]};C?l.push(g):r.push(g)}const a=l.length;let c;if(e.clueGivenRatio!=null&&e.clueGivenRatio<1){c=Math.floor(a*e.clueGivenRatio),c=Math.max(c,s);const n=Math.min(5,Math.floor(a*.2));c=Math.min(c,a-n)}else c=a;const f=l.filter(n=>n.adj<=(e.maxAdjStart??2)),h=l.filter(n=>n.adj>(e.maxAdjStart??2)).sort((n,d)=>n.adj-d.adj),p=[];for(const n of f){if(p.length>=c)break;p.push(n)}for(const n of h){if(p.length>=c)break;p.push(n)}_(p),_(r);const B=(n,d)=>Math.floor(n/3)*3+Math.floor(d/3),v=(n,d)=>Math.hypot(n.r-d.r,n.c-d.c);let m=Math.floor(t/i)+1,E=m,T=Math.max(2,Math.ceil(t/9));const k=Array(i).fill(0),R=Array(i).fill(0),H=Array(9).fill(0),I=[];for(const n of _([0,2,6,8])){const d=g=>g.filter(b=>B(b.r,b.c)===n);let C=d(p);if(C.length||(C=d(r)),C.length){const g=C[0];I.push(g),k[g.r]++,R[g.c]++,H[B(g.r,g.c)]++;const b=(w,j)=>{const P=w.findIndex(G=>G.r===j.r&&G.c===j.c);P>=0&&w.splice(P,1)};if(b(p,g),b(r,g),I.length>=Math.min(4,t))break}}function U(n,d,C=!1,g=!0){let b=0;const w=10,j=C?2:0,P=.8,G=.6,Z=.6,z=.8;for(;b<d&&n.length;){let $=-1,Y=-1;for(let x=0;x<n.length;x++){const A=n[x],O=A.r,F=A.c,L=B(O,F);if(k[O]>=m||R[F]>=E||H[L]>=T)continue;const D=I.length?Math.min(...I.map(K=>v(K,A))):99,te=A.isClue&&A.adj<=2,X=w*D+(A.isClue?j:0)+(te?P:0)-G*k[O]-Z*R[F]-z*H[L]+Q()*.05;X>Y&&(Y=X,$=x)}if($===-1){if(!g)break;m++,E++,T<6&&T++;continue}const M=n.splice($,1)[0];I.push(M),k[M.r]++,R[M.c]++,H[B(M.r,M.c)]++,b++}return b}const y=Math.max(0,s-I.filter(n=>n.isClue).length);y>0&&U(p,y,!0);const S=Math.max(0,t-I.length);if(S>0){const n=Math.min(S,p.length);n>0&&U(p,n,!0);const d=Math.max(0,t-I.length);d>0&&U(r,d,!1)}if(e.clusterize){let z=function(M){const x=n(M.r,M.c),A=Math.ceil((e.targetStartGivens||27)/i)+2,O=A,F=Math.max(4,Math.ceil((e.targetStartGivens||27)/9)+1);return d[M.r]<A&&C[M.c]<O&&g[x]<F};var u=z;const n=(M,x)=>Math.floor(M/3)*3+Math.floor(x/3),d=Array.from(k),C=Array.from(R),g=Array.from(H),b=[];for(let M=0;M<i;M++)for(let x=0;x<i;x++)o.bombs[M][x]||o.solution[M][x]===o.adj[M][x]&&b.push({r:M,c:x,adj:o.adj[M][x]});const w=(M,x)=>I.some(A=>A.r===M&&A.c===x),j=b.filter(M=>!w(M.r,M.c)),P=j.filter(M=>M.adj>=1&&M.adj<=(e.maxAdjStart??2)),G=P.length?P.slice():j.slice();_(G);const Z=Math.min(e.minClusters??0,Math.max(0,(e.targetStartGivens||27)-I.length)),$=(M,x)=>{const A=[];for(let O=M-1;O<=M+1;O++)for(let F=x-1;F<=x+1;F++)O>=0&&O<i&&F>=0&&F<i&&!(O===M&&F===x)&&A.push([O,F]);return A};let Y=0;for(;Y<Z&&G.length&&I.length<(e.targetStartGivens||27);){let M=-1,x=-1;for(let L=0;L<Math.min(G.length,40);L++){const D=G[L],X=(I.some(K=>Math.max(Math.abs(K.r-D.r),Math.abs(K.c-D.c))<=2)?2:0)+(D.adj<=2?1:0)+Q()*.1;X>x&&z(D)&&(x=X,M=L)}if(M<0)break;const A=G.splice(M,1)[0];I.push(A),d[A.r]++,C[A.c]++,g[n(A.r,A.c)]++,Y++;let O=Math.min((e.clusterSizeMin||3)+Math.floor(Q()*((e.clusterSizeMax||5)-(e.clusterSizeMin||3)+1)),(e.targetStartGivens||27)-I.length);const F=$(A.r,A.c).map(([L,D])=>({r:L,c:D,adj:o.adj[L][D],isClue:o.solution[L][D]===o.adj[L][D]})).filter(L=>L.isClue&&!w(L.r,L.c));F.sort((L,D)=>L.adj-D.adj);for(const L of F){if(I.length>=(e.targetStartGivens||27))break;if(z(L)&&(I.push(L),d[L.r]++,C[L.c]++,g[n(L.r,L.c)]++,--O<=0))break}}}const N=Array.from({length:i},()=>Array(i).fill(!1));for(const n of I)N[n.r][n.c]=!0;return{givens:N}}function ye(o,e){const t=Array.from({length:i},(y,S)=>o.bombs[S].reduce((N,u)=>N+(u?1:0),0)),s=Array.from({length:i},(y,S)=>{let N=0;for(let u=0;u<i;u++)o.bombs[u][S]&&N++;return N}),l=(y,S)=>!o.bombs[y][S]&&o.solution[y][S]===o.adj[y][S],r=(y,S)=>ee(y,S).some(([N,u])=>l(N,u)),a=Array(i).fill(0),c=Array(i).fill(0);for(let y=0;y<i;y++)for(let S=0;S<i;S++)o.bombs[y][S]&&!r(y,S)&&(a[y]++,c[S]++);const f=Array(i).fill(0),h=Array(i).fill(0);for(let y=0;y<i;y++)for(let S=0;S<i;S++)l(y,S)&&o.adj[y][S]<=2&&(f[y]++,h[S]++);const p=10,B=6,v=1.5,m=-6,E=y=>(t[y]===0||t[y]===i?m:p)+B*a[y]+v*f[y],T=y=>(s[y]===0||s[y]===i?m:p)+B*c[y]+v*h[y],k=Array.from({length:i},(y,S)=>S).sort((y,S)=>E(S)-E(y)),R=Array.from({length:i},(y,S)=>S).sort((y,S)=>T(S)-T(y));function H(y,S){const N=[];for(const u of y){if(N.length>=S)break;N.some(n=>Math.abs(n-u)<=1)||N.push(u)}for(const u of y){if(N.length>=S)break;N.includes(u)||N.push(u)}return N.slice(0,S)}const I=H(k,Math.min(e.hintRows||0,i)),U=H(R,Math.min(e.hintCols||0,i));return{hintedRows:I,hintedCols:U,rowTotals:t,colTotals:s}}function Se(o){const e=Array.from({length:i},()=>Array(i).fill(0));for(let f=0;f<i;f++)for(let h=0;h<i;h++)!o.bombs[f][h]&&o.given[f][h]&&(e[f][h]=o.solution[f][h]);const t=(f,h)=>!o.bombs[f][h]&&o.solution[f][h]===o.adj[f][h],s=[];for(let f=0;f<i;f++)for(let h=0;h<i;h++)!o.bombs[f][h]&&!o.given[f][h]&&s.push([f,h]);if(s.length<10)return!1;let l=!1,r=0;function a(f,h,p){if(t(f,h)&&p!==o.adj[f][h])return!1;for(let m=0;m<i;m++)if(m!==h&&e[f][m]===p)return!1;for(let m=0;m<i;m++)if(m!==f&&e[m][h]===p)return!1;const B=Math.floor(f/3)*3,v=Math.floor(h/3)*3;for(let m=B;m<B+3;m++)for(let E=v;E<v+3;E++)if((m!==f||E!==h)&&e[m][E]===p)return!1;return!0}function c(f){if(l||++r>me)return;if(f===s.length){for(let m=0;m<s.length;m++){const[E,T]=s[m];if(e[E][T]!==o.solution[E][T]){l=!0;return}}return}const[h,p]=s[f],B=o.solution[h][p],v=[B];for(let m=1;m<=9;m++)m!==B&&v.push(m);for(const m of v)if(a(h,p,m)&&(e[h][p]=m,c(f+1),e[h][p]=0,l))return}return c(0),l}function Be(o,e,t,s,l,r){const a=e.logicEnforcement??"sudoku_only",c=Array.from({length:i},()=>Array(i).fill(!1)),f=Array.from({length:i},()=>Array(i).fill(!1));for(let u=0;u<i;u++)for(let n=0;n<i;n++)o.given[u][n]&&(c[u][n]=!0);const h=Array.from({length:i},()=>Array.from({length:i},()=>new Set)),p=()=>{for(let u=0;u<i;u++)for(let n=0;n<i;n++){if(o.bombs[u][n]){h[u][n].clear();continue}if(c[u][n]){h[u][n]=new Set([o.solution[u][n]]);continue}const d=new Set([1,2,3,4,5,6,7,8,9]);for(let b=0;b<i;b++)c[u][b]&&d.delete(o.solution[u][b]);for(let b=0;b<i;b++)c[b][n]&&d.delete(o.solution[b][n]);const C=Math.floor(u/3)*3,g=Math.floor(n/3)*3;for(let b=C;b<C+3;b++)for(let w=g;w<g+3;w++)c[b][w]&&d.delete(o.solution[b][w]);h[u][n]=d}},B=(u,n)=>{o.bombs[u][n]||(c[u][n]=!0)},v=(u,n)=>{c[u][n]||(f[u][n]=!0)},m=(u,n)=>{const d=[];for(let C=-1;C<=1;C++)for(let g=-1;g<=1;g++){if(!C&&!g)continue;const b=u+C,w=n+g;b>=0&&b<i&&w>=0&&w<i&&d.push([b,w])}return d},E=(u,n)=>{const d=[],C=[];for(const[g,b]of m(u,n))f[g][b]?C.push([g,b]):c[g][b]||d.push([g,b]);return{u:d,f:C}};function T(){let u=!1;for(let n=0;n<i;n++)for(let d=0;d<i;d++){if(o.bombs[n][d]||c[n][d])continue;h[n][d].size===1&&(B(n,d),u=!0)}for(let n=0;n<i;n++)for(let d=1;d<=9;d++){const C=[];for(let g=0;g<i;g++)!o.bombs[n][g]&&!c[n][g]&&h[n][g].has(d)&&C.push([n,g]);C.length===1&&(B(C[0][0],C[0][1]),u=!0)}for(let n=0;n<i;n++)for(let d=1;d<=9;d++){const C=[];for(let g=0;g<i;g++)!o.bombs[g][n]&&!c[g][n]&&h[g][n].has(d)&&C.push([g,n]);C.length===1&&(B(C[0][0],C[0][1]),u=!0)}for(let n=0;n<3;n++)for(let d=0;d<3;d++)for(let C=1;C<=9;C++){const g=[];for(let b=n*3;b<n*3+3;b++)for(let w=d*3;w<d*3+3;w++)!o.bombs[b][w]&&!c[b][w]&&h[b][w].has(C)&&g.push([b,w]);g.length===1&&(B(g[0][0],g[0][1]),u=!0)}return u}let k=0;for(;k<1e3&&(p(),!!T());k++);if(!(()=>{for(let u=0;u<i;u++)for(let n=0;n<i;n++)if(!o.bombs[u][n]&&!c[u][n])return!1;return!0})())return{solvable:!1,steps:k};if(a==="sudoku_only")return{solvable:!0,steps:k};const H=new Set(t),I=new Set(s);function U(){let u=!1;for(let n=0;n<i;n++)for(let d=0;d<i;d++){if(!c[n][d]||o.solution[n][d]!==o.adj[n][d])continue;const C=o.solution[n][d],{u:g,f:b}=E(n,d),w=b.length,j=g.length;if(j){if(w===C)for(const[P,G]of g)B(P,G),u=!0;else if(w+j===C)for(const[P,G]of g)v(P,G),u=!0}}return u}function y(){let u=!1;for(const n of H){let d=[],C=0;for(let w=0;w<i;w++)f[n][w]?C++:c[n][w]||d.push([n,w]);const g=l[n],b=d.length;if(b){if(C===g)for(const[w,j]of d)B(w,j),u=!0;else if(C+b===g)for(const[w,j]of d)v(w,j),u=!0}}for(const n of I){let d=[],C=0;for(let w=0;w<i;w++)f[w][n]?C++:c[w][n]||d.push([w,n]);const g=r[n],b=d.length;if(b){if(C===g)for(const[w,j]of d)B(w,j),u=!0;else if(C+b===g)for(const[w,j]of d)v(w,j),u=!0}}return u}for(let u=0;u<1e3&&(p(),!!(T()||U()||y()));u++);let S=0;for(let u=0;u<i;u++)for(let n=0;n<i;n++)!c[u][n]&&!f[u][n]&&S++;const N=e.maxResidualUnknownCells??0;return a==="hybrid"?{solvable:S===0,steps:k}:{solvable:S<=N,steps:k}}class Me{constructor(e,t){this.boardEl=e,this.boardWrapEl=t,this.lastBoard=null,this.rowHL=document.createElement("div"),this.rowHL.id="rowHL",this.rowHL.className="hlStripe",this.colHL=document.createElement("div"),this.colHL.id="colHL",this.colHL.className="hlStripe",this.boardWrapEl.appendChild(this.rowHL),this.boardWrapEl.appendChild(this.colHL)}render(e,t){this.lastBoard=e,this.boardEl.innerHTML="";for(let s=0;s<i;s++)for(let l=0;l<i;l++){const r=this.createCell(e,s,l,t);this.boardEl.appendChild(r)}this.highlightSelected(t.selected)}renderCell(e,t,s,l){const r=t*i+s,a=this.boardEl.children[r];a&&(this.paintCell(a,e,t,s,l),this.highlightSelected(l.selected))}createCell(e,t,s,l){const r=document.createElement("div");return this.paintCell(r,e,t,s,l),r.addEventListener("mousedown",a=>{this.onCellInteract(a,t,s)}),r.addEventListener("touchstart",a=>{a.preventDefault(),this.onCellInteract(a,t,s)},{passive:!1}),r}paintCell(e,t,s,l,r){e.innerHTML="",e.className="cell",e.dataset.r=s,e.dataset.c=l,(l+1)%3===0&&l!==i-1&&e.classList.add("bRight"),(s+1)%3===0&&s!==i-1&&e.classList.add("bBottom"),t.given[s][l]?e.style.cursor="not-allowed":(!t.revealed[s][l]||!t.given[s][l])&&(e.style.cursor="pointer");const a=t.revealed[s][l],c=t.flagged[s][l],f=t.bombs[s][l],h=this.getTileType(t,s,l),p=r.selected&&r.selected.r===s&&r.selected.c===l,B=!r.gameOver&&p&&r.preview.kind;if(r.gameOver&&!r.didWin&&r.showAllBombs&&f&&!a){const v=document.createElement("div");v.className="bombmark",v.textContent="ðŸ’£",e.appendChild(v)}if(r.reviewMode&&r.gameOver&&this.paintReviewMode(e,t,s,l,a,c,f),B&&(r.preview.kind==="flag"||r.preview.kind==="note")){if(e.classList.add("covered","preview"),r.preview.kind==="flag"){const v=document.createElement("div");if(v.className="preview__flagIcon",v.textContent="âš‘",e.appendChild(v),r.preview.value!=null){const m=document.createElement("div");m.className="preview__digit",m.textContent=r.preview.value,e.appendChild(m)}}else if(r.preview.kind==="note"){const v=document.createElement("div");v.className="preview__noteIcon",v.textContent="âœŽ",e.appendChild(v);const m=document.createElement("div");m.className="preview__note",m.textContent=r.preview.value,e.appendChild(m)}return}if(a){if(e.classList.add("revealed",h),h==="bomb"){const v=document.createElement("div");v.className="bombmark",v.textContent="ðŸ’£",e.appendChild(v)}else if(t.given[s][l])e.textContent=t.solution[s][l],e.classList.add("given");else{e.classList.add("entered");const v=t.entry[s][l]||"";if(B&&r.preview.kind==="number"&&r.preview.value!=null){e.classList.add("preview");const E=document.createElement("div");E.className="preview__digit",E.textContent=r.preview.value,e.appendChild(E)}else e.textContent=v;if(r.reviewMode&&r.gameOver){const E=t.solution[s][l],T=String(v);if(T!==""&&T!==String(E)){const k=document.createElement("div");k.className="correctDigitOverlay wrong",k.textContent=E,e.appendChild(k),e.classList.add("enteredWrong")}}}return}if(e.classList.add("covered"),h==="clue"&&e.classList.add("clue"),B&&r.preview.kind==="number"){e.classList.add("preview");const v=document.createElement("div");v.className="preview__digit",v.textContent=r.preview.value,e.appendChild(v);return}if(c){e.classList.add("flag");const v=t.flagNote[s][l];if(v!=null){const m=document.createElement("div");m.className="flagDigit",m.textContent=v,e.appendChild(m)}}else{const v=t.noteText[s][l];if(v){e.classList.add("mark");const m=document.createElement("div");m.className="markDigit",m.textContent=v,e.appendChild(m)}}}paintReviewMode(e,t,s,l,r,a,c){if(!r)if(c){e.classList.add("postHiddenBomb");const f=document.createElement("div");f.className="bombmark",f.textContent="ðŸ’£",e.appendChild(f);const h=document.createElement("div");h.className="bombDigitOverlay",h.textContent=t.solution[s][l],e.appendChild(h)}else{const f=t.solution[s][l]===t.adj[s][l];e.classList.add(f?"postHiddenClue":"postHiddenSafe"),e.textContent=t.solution[s][l]}a&&(c?e.classList.add("flagRight"):e.classList.add("flagWrong"))}getTileType(e,t,s){return e.bombs[t][s]?"bomb":e.solution[t][s]===e.adj[t][s]?"clue":"normal"}onCellInteract(e,t,s){const l=this.lastBoard;l&&l.given[t][s]||this.boardEl.dispatchEvent(new CustomEvent("cellselect",{detail:{r:t,c:s,button:e.button||0}}))}highlightSelected(e){for(const l of this.boardEl.children)l.classList.remove("sel");if(!e)return;const t=e.r*i+e.c,s=this.boardEl.children[t];s&&s.classList.add("sel")}bumpCell(e,t){const s=e*i+t,l=this.boardEl.children[s];l&&(l.classList.add("bad"),setTimeout(()=>l.classList.remove("bad"),200))}renderGutters(e,t,s,l){const r=document.getElementById("rowHintsOverlay"),a=document.getElementById("colHintsOverlay");if(!r||!a)return;r.innerHTML="",a.innerHTML="";const c=this.getBoardMetrics();e.forEach(f=>{const h=document.createElement("div");h.className="gutRow",h.style.left="8px",h.style.top=c.originY+(f+.5)*c.cellH+"px",h.textContent=`ðŸ’£ ${s[f]}`,h.addEventListener("mouseenter",()=>this.showRowHL(f)),h.addEventListener("mouseleave",()=>this.hideHL()),r.appendChild(h)}),t.forEach(f=>{const h=document.createElement("div");h.className="gutCol",h.style.top="8px",h.style.left=c.originX+(f+.5)*c.cellW+"px",h.textContent=`ðŸ’£ ${l[f]}`,h.addEventListener("mouseenter",()=>this.showColHL(f)),h.addEventListener("mouseleave",()=>this.hideHL()),a.appendChild(h)})}getBoardMetrics(){const e=this.boardWrapEl.getBoundingClientRect(),t=this.boardEl.getBoundingClientRect(),s=getComputedStyle(this.boardEl),l=parseFloat(s.paddingLeft),r=parseFloat(s.paddingTop),a=parseFloat(s.paddingRight),c=parseFloat(s.paddingBottom),f=t.width-l-a,h=t.height-r-c,p=t.left-e.left+l,B=t.top-e.top+r,v=f/i,m=h/i;return{originX:p,originY:B,innerW:f,innerH:h,cellW:v,cellH:m}}showRowHL(e){const{originX:t,originY:s,innerW:l,cellH:r}=this.getBoardMetrics();this.rowHL.style.display="block",this.rowHL.style.left=t+"px",this.rowHL.style.top=s+e*r+"px",this.rowHL.style.width=l+"px",this.rowHL.style.height=r+"px",this.colHL.style.display="none"}showColHL(e){const{originX:t,originY:s,innerH:l,cellW:r}=this.getBoardMetrics();this.colHL.style.display="block",this.colHL.style.left=t+e*r+"px",this.colHL.style.top=s+"px",this.colHL.style.width=r+"px",this.colHL.style.height=l+"px",this.rowHL.style.display="none"}hideHL(){this.rowHL.style.display="none",this.colHL.style.display="none"}}class ie{constructor(){this.board=null,this.mode="story",this.gameOver=!1,this.didWin=!1,this.reviewMode=!1,this.showAllBombs=!1,this.selected=null,this.pickedDigit=null,this.flagMode=!1,this.noteMode=!1,this.noteBuffer="",this.preview={kind:null,value:null,r:-1,c:-1},this.bombsTotal=0,this.flagsCount=0,this.hintedRows=[],this.hintedCols=[],this.rowTotals=[],this.colTotals=[],this.elements=this.getDOMElements(),this.renderer=new Me(this.elements.board,this.elements.boardWrap),this.setupEventListeners(),this.loadConfig(),this.startNewGame()}getDOMElements(){return{board:document.getElementById("board"),boardWrap:document.querySelector(".boardWrap"),status:document.getElementById("status"),bombsLeft:document.getElementById("bombsLeft"),flagsCnt:document.getElementById("flagsCnt"),mode:document.getElementById("mode"),newRunBtn:document.getElementById("newRun"),reviewBtn:document.getElementById("reviewBtn"),numpad:document.getElementById("numpad"),confirm:document.getElementById("confirm"),flagBtn:document.getElementById("flagBtn"),markBtn:document.getElementById("markBtn"),removeFlagBtn:document.getElementById("removeFlagBtn"),removeMarkBtn:document.getElementById("removeMarkBtn"),asideHint:document.getElementById("asideHint"),activeConfig:document.getElementById("activeConfig"),seedDisplay:document.getElementById("seedDisplay"),seedInput:document.getElementById("seedInput"),themeToggle:document.getElementById("themeToggle"),configPanel:document.getElementById("configPanel"),saveCustomBtn:document.getElementById("saveCustom"),resetCustomBtn:document.getElementById("resetCustom"),rowHintsOverlay:document.getElementById("rowHintsOverlay"),colHintsOverlay:document.getElementById("colHintsOverlay"),cfgLives:document.getElementById("cfgLives"),cfgBombRatio:document.getElementById("cfgBombRatio"),cfgStartClues:document.getElementById("cfgStartClues"),cfgStartGivens:document.getElementById("cfgStartGivens"),cfgMaxAdj:document.getElementById("cfgMaxAdj"),cfgSpreadRows:document.getElementById("cfgSpreadRows"),cfgSpreadBlocks:document.getElementById("cfgSpreadBlocks"),valLives:document.getElementById("valLives"),valBombRatio:document.getElementById("valBombRatio"),valStartClues:document.getElementById("valStartClues"),valStartGivens:document.getElementById("valStartGivens"),valMaxAdj:document.getElementById("valMaxAdj")}}setupControlListeners(){this.controls.on("numpad-click",e=>this.onNumpadClick(e)),this.controls.on("confirm",()=>this.onConfirm()),this.controls.on("toggle-flag",()=>this.toggleFlagMode()),this.controls.on("toggle-note",()=>this.toggleNoteMode()),this.controls.on("clear-selection",()=>{this.selected=null,this.clearPreview(),this.render()}),this.controls.on("remove-flag",()=>this.removeFlag()),this.controls.on("remove-note",()=>this.removeMark()),this.controls.on("new-game",()=>this.startNewGame()),this.controls.on("cell-select",e=>{this.onCellSelect({r:e.r,c:e.c,button:0})})}setupEventListeners(){this.elements.board.addEventListener("cellselect",e=>{this.onCellSelect(e.detail)}),this.elements.newRunBtn.addEventListener("click",()=>this.startNewGame()),this.elements.reviewBtn.addEventListener("click",()=>this.toggleReview()),this.elements.confirm.addEventListener("click",()=>this.onConfirm()),this.elements.flagBtn.addEventListener("click",()=>this.toggleFlagMode()),this.elements.markBtn.addEventListener("click",()=>this.toggleNoteMode()),this.elements.removeFlagBtn.addEventListener("click",()=>this.removeFlag()),this.elements.removeMarkBtn.addEventListener("click",()=>this.removeMark()),this.elements.mode.addEventListener("change",()=>{this.mode=this.elements.mode.value,this.updateConfigUI()}),this.elements.themeToggle.addEventListener("click",()=>this.toggleTheme()),this.setupConfigListeners(),window.addEventListener("contextmenu",e=>e.preventDefault(),{passive:!1}),window.addEventListener("resize",()=>this.renderGutters())}setupConfigListeners(){[[this.elements.cfgLives,this.elements.valLives,t=>t],[this.elements.cfgBombRatio,this.elements.valBombRatio,t=>(+t).toFixed(2)],[this.elements.cfgStartClues,this.elements.valStartClues,t=>t],[this.elements.cfgStartGivens,this.elements.valStartGivens,t=>t],[this.elements.cfgMaxAdj,this.elements.valMaxAdj,t=>t]].forEach(([t,s,l])=>{t.addEventListener("input",()=>{s.textContent=l(t.value),this.mode==="custom"&&this.syncConfigFromInputs()})}),this.elements.cfgSpreadRows.addEventListener("change",()=>{this.mode==="custom"&&this.syncConfigFromInputs()}),this.elements.cfgSpreadBlocks.addEventListener("change",()=>{this.mode==="custom"&&this.syncConfigFromInputs()}),this.elements.saveCustomBtn.addEventListener("click",()=>{this.syncConfigFromInputs(),this.setStatus("Custom config saved. New Run to apply.","win")}),this.elements.resetCustomBtn.addEventListener("click",()=>{W.custom={...W.story},this.syncInputsFromConfig(W.custom),se(W.custom),this.renderActiveConfig(),this.setStatus("Custom config reset to defaults.","hint")})}loadConfig(){const e=re();e&&(W.custom={...W.custom,...e});const t=ae();this.applyTheme(t),this.updateConfigUI()}updateConfigUI(){const e=this.getActiveConfig();this.syncInputsFromConfig(e),this.applyConfigInputsEnabled(),this.renderActiveConfig()}syncInputsFromConfig(e){this.elements.cfgLives.value=e.lives,this.elements.valLives.textContent=e.lives,this.elements.cfgBombRatio.value=e.bombRatio,this.elements.valBombRatio.textContent=Number(e.bombRatio).toFixed(2),this.elements.cfgStartClues.value=e.minStartClues,this.elements.valStartClues.textContent=e.minStartClues,this.elements.cfgStartGivens.value=e.targetStartGivens,this.elements.valStartGivens.textContent=e.targetStartGivens,this.elements.cfgMaxAdj.value=e.maxAdjStart,this.elements.valMaxAdj.textContent=e.maxAdjStart,this.elements.cfgSpreadRows.checked=!!e.spreadRows,this.elements.cfgSpreadBlocks.checked=!!e.spreadBlocks}syncConfigFromInputs(){W.custom={...W.custom,lives:parseInt(this.elements.cfgLives.value,10),bombRatio:+this.elements.cfgBombRatio.value,minStartClues:parseInt(this.elements.cfgStartClues.value,10),targetStartGivens:parseInt(this.elements.cfgStartGivens.value,10),maxAdjStart:parseInt(this.elements.cfgMaxAdj.value,10),spreadRows:!!this.elements.cfgSpreadRows.checked,spreadBlocks:!!this.elements.cfgSpreadBlocks.checked},se(W.custom),this.renderActiveConfig()}applyConfigInputsEnabled(){const e=this.mode==="custom";[this.elements.cfgLives,this.elements.cfgBombRatio,this.elements.cfgStartClues,this.elements.cfgStartGivens,this.elements.cfgMaxAdj,this.elements.cfgSpreadRows,this.elements.cfgSpreadBlocks].forEach(t=>t.disabled=!e),e&&(this.elements.configPanel.open=!0)}renderActiveConfig(){const e=this.getActiveConfig();this.elements.activeConfig.textContent=`mode: ${this.mode}
bombRatio: ${e.bombRatio}
minStartClues: ${e.minStartClues}
targetStartGivens: ${e.targetStartGivens}
maxAdjForStart: ${e.maxAdjStart}
spreadByRows: ${e.spreadRows}
spreadByBlocks: ${e.spreadBlocks}
logicEnforcement: ${e.logicEnforcement}
maxResidualUnknownCells: ${e.maxResidualUnknownCells}
clusterize: ${e.clusterize}`}getActiveConfig(){return{...W[this.mode]}}startNewGame(){this.gameOver=!1,this.didWin=!1,this.reviewMode=!1,this.showAllBombs=!1,this.selected=null,this.pickedDigit=null,this.flagsCount=0,this.flagMode=!1,this.noteMode=!1,this.noteBuffer="",this.clearPreview(),this.elements.flagBtn.classList.remove("flagModeOn"),this.elements.markBtn.classList.remove("markModeOn");const e=this.getActiveConfig(),t=this.elements.seedInput.value.trim();let s=0;const l=10,r=a=>{he(a),this.elements.seedDisplay.textContent=a;const c=ge(e);return c.success?(this.board=c.board,this.bombsTotal=c.bombsTotal,this.hintedRows=c.hintedRows,this.hintedCols=c.hintedCols,this.rowTotals=c.rowTotals,this.colTotals=c.colTotals,this.elements.reviewBtn.style.display="none",this.buildNumpad(),this.render(),this.updateStats(),this.renderActiveConfig(),this.setStatus("New game started. Good luck!","hint"),!0):!1};if(t){if(this.setStatus("Generating board with seed: "+t+"...","hint"),r(t))return;console.warn(`User seed "${t}" failed to generate valid board. Trying random seeds...`),this.setStatus("Seed failed. Trying random alternatives...","hint")}else this.setStatus("Generating board...","hint");for(;s<l;){const a=Math.floor(Math.random()*1e9).toString();if(s++,r(a)){t&&this.setStatus(`Original seed failed. Using alternative seed: ${a}`,"hint");return}console.warn(`Seed attempt ${s}/${l} failed: ${a}`)}this.setStatus("âŒ Failed to generate valid board after "+l+" attempts. Try adjusting Custom mode settings or refresh the page.","lose"),console.error("Board generation failed after",l,"seed attempts")}render(){this.renderer.render(this.board,this.getUIState()),this.updateRemoveButtons(),this.renderGutters()}renderGutters(){this.renderer.renderGutters(this.hintedRows,this.hintedCols,this.rowTotals,this.colTotals)}getUIState(){return{selected:this.selected,preview:this.preview,gameOver:this.gameOver,didWin:this.didWin,reviewMode:this.reviewMode,showAllBombs:this.showAllBombs,flagMode:this.flagMode,noteMode:this.noteMode}}onCellSelect(e){if(this.gameOver)return;const{r:t,c:s,button:l}=e;if(l===2){this.setStatus("Use Flag/Note buttons above.","hint");return}if(this.clearPreview(),this.selected={r:t,c:s},this.flagMode)if(this.board.entry[t][s])this.pickedDigit=this.board.entry[t][s];else if(this.board.flagNote[t][s])this.pickedDigit=this.board.flagNote[t][s];else if(this.board.noteText[t][s]){const a=this.board.noteText[t][s].match(/\d/);a?this.pickedDigit=parseInt(a[0]):this.pickedDigit=null}else this.pickedDigit=null;else this.noteMode?this.board.noteText[t][s]?this.noteBuffer=this.board.noteText[t][s]:this.board.entry[t][s]?this.noteBuffer=String(this.board.entry[t][s]):this.noteBuffer="":(this.pickedDigit=null,this.noteBuffer="");this.setPreviewForSelected(),this.updateRemoveButtons(),this.updateHintText(),this.renderer.highlightSelected(this.selected)}toggleFlagMode(){const e=this.flagMode;if(this.flagMode=!this.flagMode,this.flagMode&&(this.noteMode=!1),this.elements.flagBtn.classList.toggle("flagModeOn",this.flagMode),this.elements.markBtn.classList.remove("markModeOn"),this.setStatus(this.flagMode?"Flag mode ON.":"Flag mode OFF.","hint"),this.selected){const{r:t,c:s}=this.selected;if(this.flagMode&&!e){if(this.pickedDigit==null){if(this.noteBuffer){const l=this.noteBuffer.match(/\d/);l&&(this.pickedDigit=parseInt(l[0]))}else if(this.board.entry[t][s])this.pickedDigit=this.board.entry[t][s];else if(this.board.flagNote[t][s])this.pickedDigit=this.board.flagNote[t][s];else if(this.board.noteText[t][s]){const r=this.board.noteText[t][s].match(/\d/);r&&(this.pickedDigit=parseInt(r[0]))}}}else this.flagMode}this.noteBuffer="",this.setPreviewForSelected(),this.updateHintText(),this.buildNumpad()}toggleNoteMode(){const e=this.noteMode;if(this.noteMode=!this.noteMode,this.noteMode&&(this.flagMode=!1),this.elements.markBtn.classList.toggle("markModeOn",this.noteMode),this.elements.flagBtn.classList.remove("flagModeOn"),this.setStatus(this.noteMode?"Note mode ON.":"Note mode OFF.","hint"),this.selected){const{r:t,c:s}=this.selected;if(this.noteMode&&!e)this.noteBuffer||(this.pickedDigit!=null?this.noteBuffer=String(this.pickedDigit):this.board.noteText[t][s]?this.noteBuffer=this.board.noteText[t][s]:this.board.entry[t][s]&&(this.noteBuffer=String(this.board.entry[t][s])));else if(!this.noteMode&&e&&this.noteBuffer){const l=this.noteBuffer.match(/\d/);l&&(this.pickedDigit=parseInt(l[0]))}}this.noteMode?this.pickedDigit=null:this.noteBuffer="",this.setPreviewForSelected(),this.updateHintText(),this.buildNumpad()}toggleReview(){this.gameOver&&(this.reviewMode=!this.reviewMode,this.elements.reviewBtn.textContent=this.reviewMode?"â—¼ Exit Review":"ðŸ‘ Review Board",this.render())}buildNumpad(){this.elements.numpad.innerHTML="";for(let e=1;e<=9;e++){const t=document.createElement("button");t.textContent=e,t.classList.add("numBtn"),t.addEventListener("click",()=>this.onNumpadClick(e)),this.elements.numpad.appendChild(t)}if(this.noteMode){const e=document.createElement("button");e.textContent="/",e.style.fontWeight="900",e.addEventListener("click",()=>this.onSlashClick()),this.elements.numpad.appendChild(e)}}onNumpadClick(e){this.selected&&(this.noteMode?(this.noteBuffer.length&&!this.noteBuffer.endsWith("/")&&(this.noteBuffer+="/"),this.noteBuffer+=String(e)):this.pickedDigit=this.pickedDigit===e?null:e,this.setPreviewForSelected())}onSlashClick(){!this.selected||!this.noteMode||(this.noteBuffer.length&&!this.noteBuffer.endsWith("/")&&(this.noteBuffer+="/"),this.setPreviewForSelected())}onConfirm(){if(this.gameOver||!this.selected){this.setStatus("Select a tile first.","lose");return}const{r:e,c:t}=this.selected;if(this.board.given[e][t]){this.setStatus("This tile is a given.","lose"),this.renderer.bumpCell(e,t);return}this.noteMode?this.confirmNote(e,t):this.flagMode?this.confirmFlag(e,t):this.confirmNumber(e,t)}confirmNote(e,t){if(!this.noteBuffer){this.setStatus("Compose a note with digits and /.","lose"),this.renderer.bumpCell(e,t);return}this.board.entry[e][t]!=null&&(this.board.entry[e][t]=null,this.board.revealed[e][t]=!1),this.board.flagged[e][t]&&(this.board.flagged[e][t]=!1,this.flagsCount=Math.max(0,this.flagsCount-1),this.board.flagNote[e][t]=null),this.board.noteText[e][t]=this.noteBuffer,this.noteBuffer="",this.setStatus("Note placed.","hint"),this.clearPreview(),this.render(),this.updateStats()}confirmFlag(e,t){this.board.entry[e][t]!=null&&(this.board.entry[e][t]=null,this.board.revealed[e][t]=!1),this.board.noteText[e][t]&&(this.board.noteText[e][t]=""),this.board.flagged[e][t]||(this.board.flagged[e][t]=!0,this.flagsCount++),this.board.flagNote[e][t]=this.pickedDigit??null,this.setStatus(this.board.flagNote[e][t]==null?"Blank flag placed.":"Flag placed.","hint"),this.clearPreview(),this.render(),this.updateStats(),this.checkWin()&&this.endGame(!0,"All safe digits correct and bombs flagged!")}confirmNumber(e,t){if(this.board.bombs[e][t]){this.endGame(!1,"You touched a bomb.");return}if(this.pickedDigit==null){this.setStatus("Pick a number 1â€“9, then Confirm.","lose"),this.renderer.bumpCell(e,t);return}this.board.entry[e][t]=this.pickedDigit,this.board.revealed[e][t]=!0,this.board.noteText[e][t]&&(this.board.noteText[e][t]=""),this.board.flagged[e][t]&&(this.board.flagged[e][t]=!1,this.flagsCount=Math.max(0,this.flagsCount-1),this.board.flagNote[e][t]=null),this.setStatus("Digit placed.","hint"),this.clearPreview(),this.render(),this.checkWin()&&this.endGame(!0,"Perfect! All correct!")}removeFlag(){if(this.gameOver||!this.selected)return;const{r:e,c:t}=this.selected;this.board.flagged[e][t]&&(this.board.flagged[e][t]=!1,this.board.flagNote[e][t]=null,this.flagsCount=Math.max(0,this.flagsCount-1),this.render(),this.updateStats(),this.setStatus("Flag removed.","hint"),!this.gameOver&&this.checkWin()&&this.endGame(!0,"All correct!"))}removeMark(){if(this.gameOver||!this.selected)return;const{r:e,c:t}=this.selected;this.board.noteText[e][t]&&(this.board.noteText[e][t]="",this.render(),this.setStatus("Note cleared.","hint"))}checkWin(){for(let e=0;e<i;e++)for(let t=0;t<i;t++)if(!this.board.bombs[e][t]&&(!this.board.revealed[e][t]||(this.board.entry[e][t]|0)!==this.board.solution[e][t]))return!1;for(let e=0;e<i;e++)for(let t=0;t<i;t++)if(this.board.bombs[e][t]&&(!this.board.flagged[e][t]||(this.board.flagNote[e][t]??null)!==this.board.solution[e][t]))return!1;return!0}endGame(e,t){this.gameOver=!0,this.didWin=!!e,e?(this.showAllBombs=!1,this.setStatus("You win! "+(t||""),"win"),this.elements.reviewBtn.style.display="none"):(this.showAllBombs=!0,this.setStatus("You lose! "+(t||""),"lose"),this.elements.reviewBtn.style.display="inline-block"),this.render()}clearPreview(){const t=this.preview&&this.preview.kind&&this.preview.r>=0?{r:this.preview.r,c:this.preview.c}:null;this.preview={kind:null,value:null,r:-1,c:-1},t&&this.board&&this.renderer.renderCell(this.board,t.r,t.c,this.getUIState())}setPreviewForSelected(){if(!this.selected||this.gameOver){this.clearPreview();return}const{r:e,c:t}=this.selected;if(this.board.revealed[e][t]&&this.board.given[e][t]){this.clearPreview();return}if(this.noteMode&&this.noteBuffer)this.preview={kind:"note",value:this.noteBuffer,r:e,c:t};else if(this.flagMode)this.preview={kind:"flag",value:this.pickedDigit??null,r:e,c:t};else if(!this.noteMode&&!this.flagMode&&this.pickedDigit!=null)this.preview={kind:"number",value:this.pickedDigit,r:e,c:t};else{this.clearPreview();return}this.renderer.renderCell(this.board,e,t,this.getUIState())}updateRemoveButtons(){if(!this.selected){this.elements.removeFlagBtn.disabled=!0,this.elements.removeMarkBtn.disabled=!0;return}const{r:e,c:t}=this.selected;this.elements.removeFlagBtn.disabled=!this.board.flagged[e][t],this.elements.removeMarkBtn.disabled=!this.board.noteText[e][t]}updateHintText(){this.flagMode?this.elements.asideHint.textContent="Flag mode: optionally add a digit to the flag; Confirm to commit.":this.noteMode?this.elements.asideHint.textContent="Note mode: tap digits and '/' to compose (e.g. 2/3); Confirm to place.":this.elements.asideHint.textContent="Number mode: pick a digit; Confirm to commit. Bombs lose instantly."}updateStats(){const e=this.countCorrectFlags(),t=Math.max(0,this.bombsTotal-e);this.elements.bombsLeft.textContent="ðŸ’£ "+t,this.elements.flagsCnt.textContent=String(this.flagsCount)}countCorrectFlags(){let e=0;for(let t=0;t<i;t++)for(let s=0;s<i;s++)this.board.bombs[t][s]&&this.board.flagged[t][s]&&e++;return e}setStatus(e,t){this.elements.status.className="status "+(t||""),this.elements.status.textContent=e}toggleTheme(){const t=(document.documentElement.getAttribute("data-theme")||"dark")==="light"?"dark":"light";this.applyTheme(t),ce(t)}applyTheme(e){const t=e==="light"?"light":"dark";document.documentElement.setAttribute("data-theme",t),this.elements.themeToggle.textContent=t==="light"?"ðŸŒ™":"â˜€ï¸"}}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",()=>new ie):new ie;
